<div id="divFileDownload" style="height:auto">
    <div id="MSG" style="display:none">
        <html xmlns="http://www.w3.org/1999/xhtml">

        <head>
            <title>Zamba - Msg Viewer</title>
            <meta http-equiv="content-type" content="text/html; charset=utf-8">
            <link href="../../Content/bootstrap.css" rel="stylesheet" />
            <!--<script src="../../Scripts/pdf.js"></script>-->
            
        </head>

        <body>
            <!--En modo preview del resultado de busqueda-->
            <div ng-show="preview != 'true'">
                <form id="frmMsgViewer">
                    <div class="form-group alert" style="margin-top: 15px; border-style: groove;">
                        <div class="form-group">
                            <div class="form-group alert">
                                <h1>{{subject}}</h1>
                                <hr />
                                <!--"Correo de" y Fecha-->
                                <div class="row">
                                    <!--Correo de:-->
                                    <div class="col-md-6">
                                        <strong><span>Correo de: </span></strong>{{from}}

                                    </div>
                                    <!--Fecha-->
                                    <div class="col-md-6">
                                        <strong><span>Fecha: </span></strong>{{date}}

                                    </div>
                                </div>

                                <!--Para:-->
                                <div class="row">
                                    <div class="col-md-12">
                                        <strong><span>Para: </span></strong>
                                        <span ng-repeat="item in to">
                                            {{item}}<span ng-if="commaSeparator(to, item)">; </span>
                                        </span>
                                    </div>
                                </div>

                            </div>
                            <br />
                            <!--Descripcion:-->
                            <div class="row">
                                <div class="col-md-12" ng-switch="height">

                                    <!--Altura de txtAreaBody para Historial de Mails-->
                                    <iframe ng-switch-when="mailHistory"
                                            id="txtAreaBody" class="form-control alert alert-primary" style="resize:vertical; height: 200px; background-color: #fff;"></iframe>

                                    <!--Altura de txtAreaBody por defecto-->
                                    <iframe ng-switch-default
                                            id="txtAreaBody" class="form-control alert alert-primary txtAreaHeight" style="resize:vertical; background-color: #fff;"></iframe>

                                    <!--Archivos:-->
                                    <div id="FileContent" ng-repeat="item in attachs">
                                        <!--Recorrer Lista de Archivos-->
                                        <div class="col-md-4">
                                            <div class="alert alert-danger" role="alert">
                                                {{item.FileName}} <br />
                                                {{fileSize_Format(item.Size, "Kb")}}

                                                <a id={{item.Id}} download={{item.FileName}} style="display:none;" />
                                                <a class="pointer" ng-click="downloadfile(item);" title="{{item.FileName}}">- Descargar</a>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <div ng-show="preview == 'true'">
                <form id="frmMsgViewerDos" style="overflow-y: scroll;height: 430px;" onmousewheel="Scroll_DocumentViewer(event)">
                    <div class="form-group alert" style="margin-top: 15px; border-style: groove;">
                        <div class="form-group">
                            <div class="form-group alert">
                                <h1>{{subject}}</h1>
                                <hr />
                                <!--"Correo de" y Fecha-->
                                <div class="row">
                                    <!--Correo de:-->
                                    <div class="col-md-6">
                                        <strong><span>Correo de: </span></strong>{{from}}

                                    </div>
                                    <!--Fecha-->
                                    <div class="col-md-6">
                                        <strong><span>Fecha: </span></strong>{{date}}

                                    </div>
                                </div>

                                <!--Para:-->
                                <div class="row">
                                    <div class="col-md-12">
                                        <strong><span>Para: </span></strong>
                                        <span ng-repeat="item in to">
                                            {{item}}<span ng-if="commaSeparator(to, item)">; </span>
                                        </span>
                                    </div>
                                </div>

                            </div>
                            <br />
                            <!--Descripcion:-->
                            <div class="row">
                                <div class="col-md-12">
                                    <iframe id="txtAreaBody" class="form-control alert alert-primary" style="resize:vertical; height: 500px; background-color: #fff;"></iframe>

                                    <!--Archivos:-->
                                    <div id="FileContent" ng-repeat="item in attachs">
                                        <!--Recorrer Lista de Archivos-->
                                        <div class="col-md-2">
                                            <div class="alert alert-danger" role="alert" style="overflow: auto; text-overflow: ellipsis; white-space: nowrap; overflow-x: hidden ">
                                                {{item.FileName}} <br />
                                                {{fileSize_Format(item.Size, "Kb")}} <br />

                                                <a id={{item.Id}} download={{item.FileName}} style="display:none;" />
                                                <a class="pointer" ng-click="downloadfile(item);" title="{{item.FileName}}">Descargar</a>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <script src="../../Scripts/toastr.js"></script>

        </body>
    </html>
</div>

<div id="PDF" style="display:none">
    <iframe id="iframeID" height="600px" width="100%"></iframe>
</div>



<div id="PDFForIE" class="PDFForIE" style="display:none">

    <div class="form-group row" style="height:100%">
        <div class="col-xs-12 iframeClassPDF" id="iframeStyle" style="overflow: auto">
            <div class="row iframeNav" ng-if="showEditor && showBtnEditor ">
                <div class="col-md-12">
                    <a id="BtnZeditor" ng-if="showBtnEditor" href="" onclick="openZambaEditor()" class="btn btn-default btn-circle" data-toggle="tooltip" title="Editar documento"><i class="fa fa-pencil-square-o"></i></a>

                </div>
            </div>
            <iframe id="previewDocIframe" class="IframeClass MargenIframe IFrameHeight" allowfullscreen webkitallowfullscreen src="../../NGTemplates/PDFViewer/viewer.html"></iframe>
            <!--<div>

                <button type="button" class="btn btn-default btn-lg StyleBtnPrevAndNext" id="prev">
                    <span class="glyphicon glyphicon-circle-arrow-left" aria-hidden="true"></span> Anterior
                </button>

                <button type="button" class="btn btn-default btn-lg StyleBtnPrevAndNext"  id="next">
                    <span class="glyphicon glyphicon-circle-arrow-right" aria-hidden="true"></span> Siguiente
                </button>

                <span>Page: <span id="page_num"></span> / <span id="page_count"></span></span>
            </div>
            <canvas id="the-canvas"></canvas>-->
        </div>
    </div>
</div>

<div id="IframeVideo" style="display:none">
    <video id="IframeVideoSrc" width="900" height="600" src="" controls>
        Your browser does not support HTML video.
    </video>
</div>
<div id="IframeAudio" style="display:none">
    <audio id="IframeAudioSrc" width="900" height="600" src="" controls>
        Your browser does not support HTML video.
    </audio>
</div>

<div id="Error404" style="display:none">
    <img src="../../Content/Images/icon-no-file.svg" style="width:300px;position:relative;" />
</div>

<div id="ErrorPreview" style="display:none">
    <img src="../../Content/Images/errorPreview.png" style="width:300px;position:relative;left:40%;margin-top:10%" />
</div>

</div>