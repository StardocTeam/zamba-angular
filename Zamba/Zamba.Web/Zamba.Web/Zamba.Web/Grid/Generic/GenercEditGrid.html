
<form editable-form name="tableform" onaftersave="saveTable()" oncancel="cancel()">



    <!-- table -->
    <table class="table table-bordered table-hover table-condensed">
        <tr style="font-weight: bold">
            <th ng-repeat="column in asociatedColumns ">{{column.Name}}</th>
            <th ng-show="!isReadOnly">Acciones</th>
        </tr>
        <tr ng-repeat="result in asociatedResults | orderBy : 'data.line'" ng-class="{'selected':indexsSelectedToDelete.includes(result.id) && deleteItems}">
            <!-- view -->
            <td ng-show="isMainView" style="width:5%">
                <span editable-text="result.data.line" e-form="tableform">
                    {{ result.data.line || ''}}
                </span>
            </td>
            <td ng-show="isMainView" style="width:28%%">
                <span editable-text="result.data.product" e-form="tableform">
                    {{ result.data.product || '' }}
                </span>
            </td>
            <td ng-show="isMainView" style="width:5%">
                <span editable-text="result.Data.reclaimantName" e-form="tableform">
                    {{ result.data.typeOfCurrency || '' }}
                </span>
            </td>
            <td ng-show="isMainView">
                <span editable-text="result.Data.reclaimantName" e-form="tableform">
                    {{ result.data.unitPrice || '' }}
                </span>
            </td>
            <td ng-show="isMainView">
                <span editable-text="result.Data.reclaimantName" e-form="tableform">
                    {{ result.data.measure || '' }}
                </span>
            </td>
            <td ng-show="isMainView" style="width:5%">
                <span editable-text="result.Data.reclaimantName" e-form="tableform">
                    {{ result.data.quantity || '' }}
                </span>
            </td>

            <td ng-show="isMainView">
                <span editable-text="result.Data.reclaimantName" e-form="tableform">
                    {{ result.data.price || '' }}
                </span>
            </td>
            <td ng-show="isMainView">
                <span editable-text="result.Data.reclaimantName" e-form="tableform">
                    {{ result.data.costCenter || '' }}
                </span>
            </td>
            <td ng-show="isMainView">
                <span editable-text="result.Data.reclaimantName" e-form="tableform">
                    {{ result.data.delegations || '' }}
                </span>
            </td>
            <td ng-show="isMainView && !isReadOnly" class="form-group row">
                <div>
                    <button type="button" ng-click="deleteResult(result.id, $index)" class="btn btn-danger fa fa-trash"></button>
                </div>
            </td>
            <!-- End view -->
            <!-- Edit -->

            <td ng-show="isEditing" style="width:5%">
                <input ng-model="result.data.line" ng-disabled="true" class="form-control input-sm" />
            </td>
            <td ng-show="isEditing" style="width:28%">
            <!--    <select class="form-control input-sm" ng-model="result.data.product"
                        ng-options="item as item for item in ProductoAttributeLists" onshow="$parent.loadAttributeList(attribute.Id)"></select>-->

                <div class="dropdown">
                    <input style="min-width: 311px;" class="dropdown-toggle form-control input-sm"
                           ng-model="result.data.product" data-toggle="dropdown">
                    <ul class="dropdown-menu list-group" style="max-height:250px; overflow-x:hidden; overflow-y:scroll; font-size: small; width: 450px">
                        <li class="list-group-item" ng-repeat="item in  productFilteredItems = (ProductoAttributeLists | filter:result.data.product)"
                            ng-click="setProductParam(item, result)">
                            {{item}}
                        </li>
                        <li class="list-group-item" ng-show="productFilteredItems.length == 0">
                            No hay coincidencias.
                        </li>
                    </ul>
                </div>


            </td>
            <td ng-show="isEditing" style="width:5%">
              <!--  <select class="form-control input-sm" ng-options="item as item for item in MonedaAttributeLists"
                        ng-model="result.data.typeOfCurrency" onshow="$parent.loadAttributeList(attribute.Id)"></select>-->

                <!--<div class="dropdown">
                    <input class="dropdown-toggle form-control input-sm" ng-model="result.data.typeOfCurrency"
                           data-toggle="dropdown">
                    <ul class="dropdown-menu list-group" style="max-height:250px; overflow-x:hidden;overflow-y:scroll; font-size: small">
                        <li class="list-group-item" ng-repeat="item in typeOfCurrencyFilteredItems = (MonedaAttributeLists | filter:result.data.typeOfCurrency)"
                            ng-click="settypeOfCurrencyParam(item, result)">
                            {{item}}
                        </li>
                        <li class="list-group-item" ng-show="typeOfCurrencyFilteredItems.length == 0">
                            No hay coincidencias.
                        </li>
                    </ul>
                </div>-->

                <select class="form-control input-sm"
                        ng-options="item as item for item in MonedaAttributeLists"
                        ng-model="result.data.typeOfCurrency" onshow="$parent.loadAttributeList(attribute.Id)"></select>


            </td>
            <td ng-show="isEditing">
                <input ng-model="result.data.unitPrice" type="number" min="0" step="0.01" ng-change="setPrice(result)" class="form-control input-sm nospin" />
            </td>
            <td ng-show="isEditing">
                <!--<select class="form-control input-sm" ng-options="item as item for item in UnidadAttributeLists"
                        ng-model="result.data.measure" onshow="$parent.loadAttributeList(attribute.Id)"></select>-->


                <!--<div class="dropdown">
                    <input class="dropdown-toggle form-control input-sm" style="width: 79px !important;" ng-model="result.data.measure" data-toggle="dropdown" />
                    <ul class="dropdown-menu list-group" style="max-height:250px; overflow-x:scroll; overflow-y:scroll; font-size: small">
                        <li class="list-group-item" ng-repeat="item in measureFilteredItems = (UnidadAttributeLists | filter:result.data.measure)"
                            ng-click="setMeasureParam(item, result)">
                            {{item}}
                        </li>
                        <li class="list-group-item" ng-show="measureFilteredItems.length == 0">
                            No hay coincidencias.
                        </li>
                    </ul>
                </div>-->

                <select class="form-control input-sm"
                        ng-options="item as item for item in UnidadAttributeLists"
                        ng-model="result.data.measure" onshow="$parent.loadAttributeList(attribute.Id)"></select>



            </td>
            <td ng-show="isEditing" style="width:5%">
                <input ng-model="result.data.quantity" min="0" type="number" ng-change="setPrice(result)" class="form-control input-sm nospin" />
            </td>
            <td ng-show="isEditing">
                <input ng-model=" result.data.price " ng-disabled="true" class="form-control input-sm nospin" />
            </td>
            <td ng-show="isEditing">
                <!--<input ng-model="result.data.costCenter" class="form-control input-sm" />-->
                <!--<select class="form-control input-sm" ng-options="item as item for item in costCenterList"
                        ng-model="result.data.costCenter" onshow="$parent.loadAttributeList(attribute.Id)"></select>-->

                <div class="dropdown">
                    <input class="dropdown-toggle form-control input-sm" ng-model="result.data.costCenter" data-toggle="dropdown">
                    <ul class="dropdown-menu list-group" style="max-height:250px; overflow-x:hidden; overflow-y:scroll; font-size: small; width: 250px">
                        <li class="list-group-item" ng-repeat="item in costCenterFilteredItems = (costCenterList | filter:result.data.costCenter)"
                            ng-click="setCostCenterParam(item, result)">
                            {{item}}
                        </li>
                        <li class="list-group-item" ng-show="costCenterFilteredItems.length == 0">
                            No hay coincidencias.
                        </li>
                    </ul>
                </div>


            </td>
            <td ng-show="isEditing">
                <!--<select class="form-control input-sm" ng-options="item as item for item in delegationsList"
                        ng-model="result.data.delegations" onshow="$parent.loadAttributeList(attribute.Id)"></select>-->

                <div class="dropdown">
                    <input class="dropdown-toggle form-control input-sm" ng-model="result.data.delegations" data-toggle="dropdown">
                    <ul class="dropdown-menu list-group" style="max-height:250px; overflow-x:hidden; overflow-y:scroll; font-size: small; width: 250px">
                        <li class="list-group-item" ng-repeat="item in delegationsFilteredItems = (delegationsList | filter:result.data.delegations)"
                            ng-click="setdelegationsParam(item, result)">
                            {{item}}
                        </li>
                        <li class="list-group-item" ng-show="delegationsFilteredItems.length == 0">
                            No hay coincidencias.
                        </li>
                    </ul>
                </div>

            </td>




            <!-- End Edit -->
            <!--<td ng-show="isEditing">
                <button type="button"  ng-click="EditResult(result.id, result.data.reclaimantName, result.data.reclaimentType)" class="btn btn-primary fa fa-pencil"></button>
            </td>-->

        </tr>
        <tr ng-show="isInserting">
            <!-- Insert -->
            <td style="width:5%">
                <input ng-model="result.data.line" ng-disabled="true" class="form-control input-sm" />
            </td>
            <td>
                <div class="dropdown">
                    <input style="min-width: 311px;" class="dropdown-toggle form-control input-sm"
                           ng-init="product = ''"
                           ng-model="product" data-toggle="dropdown">
                    <ul class="dropdown-menu list-group" style="max-height:200px; overflow-x:hidden; overflow-y:scroll; font-size:small; width:450px">
                        <li class="list-group-item" ng-repeat="item in  productFilteredItems = (ProductoAttributeLists | filter:product)"
                            ng-click="setProductParam(item, null)">
                            {{item}}
                        </li>
                        <li class="list-group-item" ng-show="productFilteredItems.length == 0">
                            No hay coincidencias.
                        </li>
                    </ul>
                </div>
            </td>
            <td style="width:5%">
                <!--<div class="dropdown">
                    <input class="dropdown-toggle form-control input-sm" ng-model="typeOfCurrency"
                           data-toggle="dropdown"
                           ng-init="typeOfCurrency = MonedaAttributeLists [0]">
                    <ul class="dropdown-menu list-group" style="max-height:250px; overflow-x:hidden;overflow-y:scroll; font-size: small">
                        <li class="list-group-item" ng-repeat="item in typeOfCurrencyFilteredItems = (MonedaAttributeLists | filter:typeOfCurrency)"
                            ng-click="settypeOfCurrencyParam(item, null)">
                            {{item}}
                        </li>
                        <li class="list-group-item" ng-show="typeOfCurrencyFilteredItems.length == 0">
                            No hay coincidencias.
                        </li>
                    </ul>
                </div>-->


                <select class="form-control input-sm"
                        ng-init="result.data.typeOfCurrency = MonedaAttributeLists[0]"
                        ng-options="item as item for item in MonedaAttributeLists"
                        ng-model="result.data.typeOfCurrency" onshow="$parent.loadAttributeList(attribute.Id)">
                </select>


            </td>
            <td>
                <input ng-model="result.data.unitPrice" type="number" step="0.01" min="0"
                       ng-change="this.toFixed(2);setPrice(result);" class="form-control input-sm" />
            </td>
            <td>
                <!--<div class="dropdown">
                    <input class="dropdown-toggle form-control input-sm" style="width: 79px !important;" ng-model="measure" data-toggle="dropdown"
                           ng-init="measure = UnidadAttributeLists[1]">
                    <ul class="dropdown-menu list-group" style="max-height:200px; overflow-x:scroll; overflow-y:scroll; font-size: small">
                        <li class="list-group-item" ng-repeat="item in measureFilteredItems = (UnidadAttributeLists | filter:measure)"
                            ng-click="setMeasureParam(item, null)">
                            {{item}}
                        </li>
                        <li class="list-group-item" ng-show="measureFilteredItems.length == 0">
                            No hay coincidencias.
                        </li>
                    </ul>
                </div>-->


                <select class="form-control input-sm"
                        ng-init="result.data.measure = UnidadAttributeLists[1]"
                        ng-options="item as item for item in UnidadAttributeLists"
                        ng-model="result.data.measure" onshow="$parent.loadAttributeList(attribute.Id)"></select>

            </td>
            <td style="width:5%">
                <input ng-model="result.data.quantity" type="number" min="0" ng-change="setPrice(result)" class="form-control input-sm nospin" />
            </td>
            <td>
                <input ng-model="result.data.price" type="number" step="0.01" ng-disabled="true" class="form-control input-sm nospin" />
            </td>

            <td>
                <div class="dropdown">
                    <input class="dropdown-toggle form-control input-sm" ng-model="costCenter" data-toggle="dropdown">
                    <ul class="dropdown-menu list-group" style="max-height:250px; overflow-x:hidden; overflow-y:scroll; font-size: small; width: 250px">
                        <li class="list-group-item" ng-repeat="item in costCenterFilteredItems = (costCenterList | filter:costCenter)"
                            ng-click="setCostCenterParam(item, null)">
                            {{item}}
                        </li>
                        <li class="list-group-item" ng-show="costCenterFilteredItems.length == 0">
                            No hay coincidencias.
                        </li>
                    </ul>
                </div>
            </td>
            <td>
                <div class="dropdown">
                    <input class="dropdown-toggle form-control input-sm" ng-model="delegations" data-toggle="dropdown">
                    <ul class="dropdown-menu list-group" style="max-height:250px; overflow-x:hidden; overflow-y:scroll; font-size: small; width:250px">
                        <li class="list-group-item" ng-repeat="item in delegationsFilteredItems = (delegationsList | filter:delegations)"
                            ng-click="setdelegationsParam(item, null)">
                            {{item}}
                        </li>
                        <li class="list-group-item" ng-show="delegationsFilteredItems.length == 0">
                            No hay coincidencias.
                        </li>
                    </ul>
                </div>
            </td>

            <td style="width:5%">
                <button type="button" ng-click="insertResult(result)" class="btn btn-primary glyphicon glyphicon-ok"></button>
            </td>
            <!-- Insert -->
        </tr>

    </table>

    <div ng-show="!isEditing && !deleteItems">
        <div class="col-md-4">
            <div class="input-group">
                <span class="input-group-addon">Total:</span>
                <input ng-model="total" ng-disabled="true" class="form-control" />
            </div>
        </div>
    </div>
    <!-- buttons -->
    <div class="btn-edit" ng-show="!isInserting && !isEditing && !deleteItems">
        <button type="button" ng-show="!firtTime && !isReadOnly" class="btn btn-warning pull-right" ng-click="EditResultMode()">
            Editar
        </button>
        <button type="button" ng-show="!isReadOnly" ng-click="addResult()" style="margin-left:5px" class="btn btn-success pull-right">
            Nuevo
        </button>

    </div>
    <div class="btn-form" ng-show="isInserting || isEditing || deleteItems">
        <button type="button" ng-disabled="tableform.$waiting" ng-click="saveTable()" class="btn btn-primary">Guardar Cambios</button>
        <button type="button" ng-disabled="tableform.$waiting" ng-click="cancelModification(result)" class="btn btn-default">Cancelar Cambios</button>
    </div>
    <style>
        .selected {
            background: #D4CAC7;
            opacity: 0.9;
        }

        ::-webkit-scrollbar-thumb {
            -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
            background-color: #F5F5F5;
            border-radius: 10px;
        }

        .upload-btn-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }



            .upload-btn-wrapper input[type=file] {
                font-size: 100px;
                position: absolute;
                left: 0;
                top: 0;
                opacity: 0;
            }

        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
    </style>

</form>
