<html>
	<head>
		<title>Indemnizacion/Gasto de Proveedor</title>			
		
    <link href="Aysa_styles.css" type="text/css" rel="stylesheet"/>
    <link href="Aysa_styles_table.css" type="text/css" rel="stylesheet"/>
    <link href="demo_table.css" rel="stylesheet" type="text/css" />
    <link href="demo_page.css" rel="stylesheet" type="text/css" />

    <script src="Industria.js" type="text/javascript" language="JavaScript"></script>
    <script type="text/javascript" src="jquery.validate.min.js"></script>
    <script type="text/javascript" src="jquery.decimalMask.1.1.1.min.js"></script>
    
    <script type="text/javascript" src="jquery.dataTables.js"></script>
	<script type="text/javascript" src="jquery.scrollTo.js"></script>
    <script type="text/javascript" src="Aysa.js"></script>

    <script type="text/javascript" language="JavaScript">
        function makeCalendar(id) {
            $(function () {
                $('#' + id).datepicker({
                    changeMonth: true,
                    changeYear: true,
                    showOn: 'both',
                    buttonText: 'Abrir calendario',
                    buttonImage: 'images/calendar.png',
                    buttonImageOnly: true,
                    duration: "",
                    maxDate: '+0d',
                    dateFormat: 'dd/mm/yy',
                    constrainInput: true
                });
            });
        }

        function MakeCalendarAfterValue(idSource, idDestiny) {
            var mindate = $("#" + idSource).val().split("/");
            $('#' + idDestiny).datepicker("option", "minDate", new Date(mindate[2], mindate[1] - 1, mindate[0]));
        }

        //Ezequiel: Funcion que selecciona automaticamente los valores relacionados en dos indices
        function AssociateIndexs(index1, index2) {
            $("#" + index1).change(
                    function () {
                        $("#" + index2 + " option").each(
                          function () {
                              if ($(this).val().trim() == $("#" + index1 + " option:selected").val().trim()) {
                                  $(this).attr("selected", "selected");
                              }
                          }
                       );
                        $("#" + index2).valid();
                    }
                );
        }

        //Función que evalua si habilitar o no un control en base a uno o dos valores
        function ConditionalEnable(ObjSource, ObjDestiny, Value, Value2) {
            if ($("#" + ObjSource).val() == Value || (Value2 != undefined && $("#" + ObjSource).val() == Value2)) {

                //Quita la clase que ignora el validate y valida el control nuevamente
                $("#" + ObjDestiny).removeClass("disable");
                $("#" + ObjDestiny).valid();
                //Habilita el datepicker
                $("#" + ObjDestiny).datepicker("enable");
                //Muestra el asterisco para marcar que es un campo requerido.
                $("#lbl_" + ObjDestiny).show();
                $("#" + ObjDestiny).attr('disabled', '');

                //                if ($("#" + ObjDestiny).datepicker("option", "disabled") === undefined) {
                //                    $("#" + ObjDestiny).attr('disabled', 'disabled');
                //                }
            }
            else {
                $("#" + ObjDestiny).attr('disabled', 'disabled');
                $("#" + ObjDestiny).val("");
                if ($("#" + ObjDestiny)[0].length > 1) {
                    var i;
                    for (i = 0; i < $("#" + ObjDestiny)[0].length; i++)
                        if ($("#" + ObjDestiny)[0][i].innerHTML == "A Definir")
                            $("#" + ObjDestiny)[0][i].selected = true;
                        else
                            $("#" + ObjDestiny)[0][i].selected = false;
                }
                //$("#ObjDestiny").selectedIndex = -1;
                //Agrega la clase que ignora el validate y valida el control nuevamente
                $("#" + ObjDestiny).addClass("disable");
                $("#" + ObjDestiny).valid();
                //Oculta el asterisco para marcar que es un campo requerido.
                $("#lbl_" + ObjDestiny).hide();
                //deshabilita el datepicker
                $("#" + ObjDestiny).datepicker("disable");
                $("#" + ObjDestiny).change();
            }
        }

        //Crea las validaciones de los campos
        function makerequired() {
            $('#aspnetForm').validate(
				{
				    onsubmit: false,
				    ignore: ".disable",
				    rules: {
				        //Razon social
				        zamba_index_26028: {
				            required: true,
				            maxlength: 150
				        }
				    },
				    messages: {
				        //Tipo de industria
				        zamba_index_26028: {
				            required: "Debe seleccionar el Afiliado.",
				            digits: "Debe seleccionar el Afiliado."
				        }
				    }
				}
				);
        }

        function ajustarselects() {
            if ($.browser !=undefined && $.browser.msie) {
                $('select').each(function () {
                    if ($(this).attr('multiple') == false) {
                        $(this).mousedown(function () {
                            if ($(this).css("width") != "auto") {
                                var width = $(this).width();
                                $(this).data("origWidth", $(this).css("width")).css("width", "auto");

                                // If the width is now less than before then undo 
                                if ($(this).width() < width) {
                                    $(this).unbind('mousedown');
                                    $(this).css("width", $(this).data("origWidth"));
                                }
                            }
                        })

                        // Handle blur if the user does not change the value 
                .blur(function () {
                    $(this).css("width", $(this).data("origWidth"));
                })

                        // Handle change of the user does change the value 
                .change(function () {
                    $(this).css("width", $(this).data("origWidth"));
                });
                    }
                });
            }
        }

        $(document).ready(function () {

            ajustarselects();
			makeCalendar('zamba_index_26427');
            makerequired();
//            AssociateIndexs("zamba_index_1189", "zamba_index_1223");
//            AssociateIndexs("zamba_index_1223", "zamba_index_1189");

//            MakeCalendarAfterValue('zamba_index_1214', 'zamba_index_1215');

//            $("#ctl00_ContentPlaceHolder_InsertControl_btn_insertar").onclick = ValidateBeforeSave;

//            $("#ctl00_ContentPlaceHolder_InsertControl_btn_insertar").click(function () {
//                ShowLoadingAnimation();
//            });

            //Agregado 15-11-2011
            GetCurrentDate();
            SelectActiveState();
        });

        function ValidacionPersonalizada(evt) {
            var isValid = true;
            //Recorro elementos del fieldset validando si se completaron
            $('.GeneralFormControl').each(function (i, item) {
                if (!$(item).valid()) {
                    isValid = false;
                }
            });


            if (!isValid) {
                evt.preventDefault();
            }
            else {
                $('#TAB').tabber.tabShow(1);
            }
        }

        var itemToScroll = null;
        function ValidateBeforeSave() {

            var isValid = true;
            var tabIndex = 0;

            //Recorro elementos del fieldset validando si se completaron
            $('.GeneralFormControl').each(function (i, item) {
                if (!$(item).valid()) {
                    isValid = false;
                    if (itemToScroll === null)
                        itemToScroll = $(item);
                }
            });

            if (itemToScroll != null) {
                $.scrollTo(itemToScroll, 600);
                setTimeout("itemToScroll.focus();itemToScroll=null;", 600);
            }

            if (!isValid) {
                $('#TAB').tabber.tabShow(tabIndex);
                setTimeout("parent.hideLoading();", 1000);
            }
            else {
                ConvertToUpperForm();
                __doPostBack('ctl00$ContentPlaceHolder$InsertControl$btn_insertar', '');
            }
        }

        //Funciones agregadas 15-11-211

        function GetCurrentDate() {

            var myDate = new Date();
            var d = myDate.getDate() + '/' + (myDate.getMonth() + 1) + '/' + myDate.getFullYear();
            //Asignamos a fecha de alta el valor actual
            $("#zamba_index_26427").val(d);
        }

        function SelectActiveState() {
//            var option = $("#zamba_index_1211").find("option[value='Activa']");
//            if (option != null)
//                option.attr("selected", "selected");
        }


        //Funciones agregadas 23-11-2011

        function ConvertToUpperForm() {
//            $('.ConvertToUpper').each(function (i, item) {
//                var cadena = $(item).val();
//                cadena = cadena.toUpperCase();
//                $(item).val(cadena);
//            });
        }
        
		function SetRuleId(sender){
				$("#hdnRuleId").name = sender.id;               
				frmMain.submit();
		}
		
		function SetAsocId(sender){
			$("#hdnAsocId").name = sender.id;
			frmMain.submit();
		}
		
		function zamba_save_onclick(){

		}

		function dateToString(date){
			var dia = date.split("/")[0];
			var mes = date.split("/")[1];
			var ano = date.split("/")[2];

			dia = format(dia);
			mes = format(mes);
			
			return ano + mes + dia;			
		}

		function format(txt){
			if(txt.length == 1) txt = "0" + txt;
			
			return txt;
		}

		function makeCalendar(id){
			$(function() 
			{
				$('#' + id).datepicker({
					changeMonth: true,
					changeYear: true,
					showOn: 'button', 
					buttonText: 'Abrir calendario',
					buttonImage: 'images/calendar.png', 
					buttonImageOnly: true,
					duration: ""
				});
			});
		}

		$(document).ready(function(){							
			
			// Valida solo numericos
			// Agregar class="solonum" a todos los inputs que se quieran validar
			$(".solonums").each(function(){
				$(this).keypress(function (e){
					if (e.which!=8 && e.which!=0 && e.which!=45 && e.which!=44 && (e.which<48 || e.which>57)){
						return false;
					}
				})
			});
		});			
	</script>
</head>
<body>
	<div id="container">
		<form name="frmMain" method="post">
			<input id="hdnRuleId" type="hidden" />
			<input id="hdnAsocId" type="hidden" />
				<div id="design">
					<strong>Ingreso de Reintegro</strong>
				</div>
				<br />
				<table cellpadding="4">
					<tr>
						<td><label>PSC Nro:</label></td>
						<td><input type="text" id="zamba_index_26450" name="zamba_index_26450" style="width:250px;" readOnly="readOnly"  class="ReadOnly"/></td>
						<td class="separador" style="width:20px !important"></td>
						<td><label>Fecha:</label></td>
						<td><input type="text" id="zamba_index_26427" name="zamba_index_26427" style="width:150px;"/></td>		
					</tr>
					
					<tr>
						<td><label>Afiliado: </label></td>
						<td><select name="zamba_index_26314" id="zamba_index_26314" style="width:250px;" ></select></td>
						<td class="separador"></td>
					</tr>
					<tr>
						<td>
						<label>Obervaciones:</label>
						</td>
						<td colspan="4">
						<textarea cols="110" rows="10" id="zamba_index_64" name="zamba_index_64"></textarea>
						</td> 
					</tr>
				</table>
				<br />
				<center>
				<div id="aligncenter">
					<input type="submit" name="zamba_save" id="zamba_save" value="Siguiente"  onclick="return zamba_save_onclick()" /> 
				</div>
				</center>
			</form>						
		</div>
	</body>
</html>