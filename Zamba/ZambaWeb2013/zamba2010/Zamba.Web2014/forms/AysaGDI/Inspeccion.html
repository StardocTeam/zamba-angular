<html>
<head>
    <title>Inspecci&oacuten</title>
    <link href="Aysa_styles.css" type="text/css" rel="stylesheet"/>
    <link href="Aysa_styles_table.css" type="text/css" rel="stylesheet"/>
    <script type="text/javascript" src="Scripts/Aysa.js"></script>	

    <script type="text/javascript" language="JavaScript">
        function SetRuleId(sender) {
            document.getElementById("hdnRuleId").name = sender.id;
            frmMain.submit();
        }

        function makeCalendar(id, limit) {
            switch (limit) {
                case "smaller": $(function() {
                                    $('#' + id).datepicker({
                                        changeMonth: true,
                                        changeYear: true,
                                        showOn: 'both',
                                        buttonText: 'Abrir calendario',
                                        buttonImage: 'images/calendar.png',
                                        buttonImageOnly: true,
                                        duration: "",
                                        maxDate: '+0d',
                                        dateFormat: 'dd/mm/yy',
                                        constrainInput: true
                                    });
                                });
                                break;
                    case "bigger": $(function() {
                                    $('#' + id).datepicker({
                                        changeMonth: true,
                                        changeYear: true,
                                        showOn: 'both',
                                        buttonText: 'Abrir calendario',
                                        buttonImage: 'images/calendar.png',
                                        buttonImageOnly: true,
                                        duration: "",
                                        minDate: "+0d",
                                        dateFormat: 'dd/mm/yy',
                                        constrainInput: true
                                    });
                                });
                        break;
                    case "normal": $(function() {
                        $('#' + id).datepicker({
                            changeMonth: true,
                            changeYear: true,
                            showOn: 'both',
                            buttonText: 'Abrir calendario',
                            buttonImage: 'images/calendar.png',
                            buttonImageOnly: true,
                            duration: "",
                            dateFormat: 'dd/mm/yy',
                            constrainInput: true
                        });
                    });
                        break;
            }
        }

        //Función que evalua si habilitar o no un control en base a si el control fuente está vacio
        function ConditionalEnable(ObjSource, ObjDestiny) {
            if ($("#" + ObjSource).val() != "") {

                //Quita la clase que ignora el validate y valida el control nuevamente
                $("#" + ObjDestiny).removeClass("disable");
                $("#" + ObjDestiny).valid();
                //Habilita el datepicker
                $("#" + ObjDestiny).datepicker("enable");
                //Muestra el asterisco para marcar que es un campo requerido.
                $("#lbl_" + ObjDestiny).show();
               // $("#" + ObjDestiny).attr('disabled', '');

              //  if ($("#" + ObjDestiny).datepicker("option", "disabled") === undefined) {
               //     $("#" + ObjDestiny).attr('disabled', 'disabled');
              //  }
            }
            else {                
              //  $("#" + ObjDestiny).attr('disabled', 'disabled');
                $("#" + ObjDestiny).val("");
                //Agrega la clase que ignora el validate y valida el control nuevamente
                $("#" + ObjDestiny).addClass("disable");
                $("#" + ObjDestiny).valid();
                //Oculta el asterisco para marcar que es un campo requerido.
                $("#lbl_" + ObjDestiny).hide();
                //deshabilita el datepicker
                $("#" + ObjDestiny).datepicker("disable");
            }
        }

        function ValidateLength(element, RequiredLength) {
            var Str = element.value;
            $(element).valid();
            if (Str.length < RequiredLength)
                return true;
            return false;
        }

        //Funcion que evalúa si una tecla pulsada pertenece al tipo dado
        function KeyIsValid(e, TypeToValidate, Obj) {

            var key = e.charCode || e.keyCode || 0;
            var isValid = false;

            switch (TypeToValidate) {
                case "numeric":
                    if (key >= 48 && key <= 57)
                        isValid = true;
                    break;
                case "date":
                    if ((key >= 48 && key <= 57) || key == 47)
                        isValid = true;
                    break;
                case "2decimal":
                    var currentValue = $("#" + Obj).val();
                    var commaPos = currentValue.indexOf('.');
                    var caretPos = $("#" + Obj).caret().start;

                    if (key == 46)
                        isValid = (commaPos == -1 && caretPos != 0);
                    else {
                        if ((key >= 48 && key <= 57)) {
                            if (commaPos == -1) {
                                isValid = (currentValue.length < 6);
                            }
                            else {
                                if (caretPos > commaPos) {
                                    isValid = (currentValue.length - 3 < commaPos);
                                }
                                else
                                    isValid = (commaPos < 6);
                            }
                        }
                    }
                    break;
            }

            return isValid;
        }

        //Crea las validaciones de los campos
        function makerequired() {
            $('#aspnetForm').validate(
				{
				    onsubmit: false,
				    ignore: ".disabled",
				    rules: {
				        zamba_index_1224: {
				            required: true,
				            maxlength: 14
				        },
				        zamba_index_1229: {
				            maxlength: 300
				        },
						zamba_index_1225: {
				            required: true
				        },
						zamba_index_1227: {
				            required: true
				        },
						zamba_index_1228: {
				            required: true
				        }
				    },
				    messages: {
				        zamba_index_1224: {
				            required: "Es necesario un número de ODT.",
				            maxlength: "Se ha exedido el límite de 14 caracteres."
				        },
				        zamba_index_1229: {
				            maxlength: "Se ha exedido el límite de 300 caracteres."
				        },
						zamba_index_1225: {
				            required: "Es necesario el campo Fecha inspección."
				        },
						zamba_index_1227: {
				            required: "Es necesario el campo Resultado."
				        },
						zamba_index_1228: {
				            required: "Es necesario el campo Motivo."
				        }
				    }
				});
        }

        $(document).ready(function() {
             makeCalendar('zamba_index_1225', "smaller");
            makeCalendar('zamba_index_1226', "bigger");

            makerequired();

            ConditionalEnable('zamba_index_1225', 'zamba_index_1226');
            
            $("#zamba_save").click(ValidateBeforeSave);
        });				
	
    </script>

</head>
<body>
    <form name="frmMain" method="post">
    <input id="hdnRuleId" type="hidden" />
    <div name="design" id="design">
        <strong>Inspecci&oacuten</strong>
    </div>
	<br/>
                	<input id="zamba_rule_19762" class="submit ZambaRule" name="zamba_rule_19762"
                                    type="submit" style="text-align: center; margin-right: 25px;"
                                    value="Ir a industria" />    
 <div class="tabber">
   
     <div class="tabbertab">
                    <h2>Inspeccion</h2>
    <div>

            <input type="text" id="zamba_index_1217" name="zamba_index_1217" style="width: 150px;
                display: none;" />
            <table cellpadding="4">
                <tr>
                    <td>
                        <label>
                            Nro de ODT:</label>
                    </td>
                    <td>
                        <input type="text" id="zamba_index_1224" name="zamba_index_1224" class="ConvertToUpper" style="width: 150px;"  onkeypress="return ValidateLength(this, 14);"/>
                    </td>
                    <td>
                        <label>
                            Inspector:</label>
                    </td>
                    <td>
                        <input type="text" id="zamba_index_1239" name="zamba_index_1239" class="ConvertToUpper" style="width: 150px;" />
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            Fecha Inspecci&oacuten:
                        </label>
                    </td>
                    <td>
                        <input type="text" id="zamba_index_1225" name="zamba_index_1225" style="width: 150px" onchange="ConditionalEnable('zamba_index_1225','zamba_index_1226');"/>
                    </td>
                    <td>
                        <label>
                            Fecha Pr&oacutexima Inspecci&oacuten:
                        </label>
                    </td>
                    <td>
                        <input type="text" id="zamba_index_1226" name="zamba_index_1226" style="width: 150px;"/>
                    </td>
                </tr>
				                <tr>
                    <td>
                        <label>
                            Fecha programada:
                        </label>
                    </td>
                    <td>
                        <input type="text" id="zamba_index_11358" name="zamba_index_11358" style="width: 150px"/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>
                            Resultado:
                        </label>
                    </td>
                    <td>
                        <select id="zamba_index_1227" name="zamba_index_1227" style="width: 150px;">
                        </select>
                    </td>
                    <td>
                        <label>
                            Motivo:
                        </label>
                    </td>
                    <td>
                        <select id="zamba_index_1228" name="zamba_index_1228" style="width: 150px;">
                        </select>
                    </td>
                </tr>
								<tr>
				<td class="style2">
                                <label>
                                    Firm&oacute CN:
								</label>
                            </td>
                            <td>
                                <input type="checkbox" id="zamba_index_11337" name="zamba_index_11337" size="28" />
                            </td>
				</tr>
                <tr>
                    <td>
                        <label>
                            Observaciones:</label>
                    </td>
                    <td colspan="4">
                        <textarea cols="100" rows="10" id="zamba_index_1229" name="zamba_index_1229" class="ConvertToUpper" onkeypress="return ValidateLength(this, 300);"></textarea>
                    </td>
                </tr>
            </table>
        </div>

</div>
       

                  <div class="tabbertab">
                    <h2>
                        Documentacion</h2>
                    <table cellpadding="4">
                    <tr>
                    <td>
                                         <input id="zamba_rule_8062" type="submit" style=" text-align: center; margin-right: 25px;"
             class="submit" value="Agregar Documentacion" name="zamba_rule_8062" /> 
                    </td>
                    </tr>
                        <tr>
                            <td>
                                <label>
                                    Documentacion asociada:</label>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <table id="zamba_associated_documents_1049" class="tablesorter">
                                    <tbody>
                                    </tbody>
                                </table>
                            </td>
                        </tr>
                    </table>
                </div>
</div>
   
    <br />
    <div name="logoAysa" id="logoAysa">
        <img src="Content/Images/Aysa.bmp" align="left" height="50" width="70">
    </div>
    <div name="logozamba" id="logozamba">
        <img src="Content/Images/pwbyzamba.jpg">
    </div>
    <div name="alignleft" id="alignleft">
        <input type="submit" class="submit" name="zamba_save" id="zamba_save" value="GUARDAR" />
    </div>
    </form>
</body>
</html>
